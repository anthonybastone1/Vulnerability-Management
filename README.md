<p align="center">
<img src="https://imgur.com/BdlvjS0.png" height="80%" width="80%"/>

</p>

<h1>Vulnerability Management - Nessus</h1>

<h2>Description</h2>
In this project, I installed and configured Nessus Essentials to perform credentialed and uncredentialed vulnerability scans against a Windows 11 host and remediate them. Following the Vulnerability Management Life Cycle (Identify, Prioritize, Assess, Remediate, Verify, Report) on a sandbox network.

<h2>Key Objectives</h2>

- Download and install Nessus Essentials.
- Deploy a Windows 11 virtual machine inside of VMware.
- Conduct an uncredentialed vulnerability assessment with Nessus.
- Conduct a credentialed vulnerability assessement with Nessus.
- Install a deprecated version of Firefox and run a vulnerabilitiy assessment.
- Remediate vulnerabilities.
  
<h2>Languages and Utilities Used</h2>

- <b>Nessus Essentials</b>
- <b>Firefox v3.6.12<b/>

<h2>Environments Used </h2>

- <b>VMware Fusion Pro</b>
- <b>Windows 11 VM</b>

<h2>Contents</h2>

- [Install Nessus Essentials](https://github.com/anthonybastone1/Vulnerability-Management#install-nessus-essentials)
- [Create Windows 11 Virtual Machine](https://github.com/anthonybastone1/Vulnerability-Management#create-windows-11-virtual-machine)
- [Create a New Scan](https://github.com/anthonybastone1/Vulnerability-Management#create-a-new-scan)
- [Credentialed Scan](https://github.com/anthonybastone1/Vulnerability-Management#credentialed-scan)
- [Install Deprecated Firefox on VM](https://github.com/anthonybastone1/Vulnerability-Management#install-deprecated-firefox-on-vm)
- [Remediate Vulnerabilities](https://github.com/anthonybastone1/Vulnerability-Management#remediate-vulnerabilities)

<br/>
<h2>Install Nessus Essentials:</h2>

<p align="center">
<br />
Navigate to Tenable Nessus Essentials.
<br/>
<br/>
Register for an activation code.
<br/>
<br/>
Once you receive the email with your activation code, click Download Nessus and download and install the latest version for your OS.
<br/>
<br/>
<img src="https://imgur.com/bdEMZw3.png" height="80%" width="80%"/>
<br/>
<br/>
<img src="https://imgur.com/13jpygi.png" height="80%" width="80%"/>
<br/>
<br/>
Connect via SSL. Nessus will begin its setup process, initialize, download, and install definitions, plugins, etc.
<br/>
<br/>
Make sure to select Nessus Essentials when prompted.
<br/>
<br/>
You will be presented with a certificate that you need to paste in the Nessus terminal, along with your activation code that you've received via email.
<br/>
<br/>
You will then be prompted to create a username and password before being able to login.
<br/>
<br/>
<img src="https://imgur.com/era30tt.png" height="80%" width="80%"/>
<br/>
<br/>

<h2>Create Windows 11 Virtual Machine:</h2>

<p align="center">
<br />
Once Nessus has been installed, we will spin up our Windows 11 VM inside of VMware Fusion Pro.
<br/>
<br/>
Select Create New Virtual Machine
<br/>
<br/>
<img src="https://imgur.com/xYjMqri.png" height="80%" width="80%"/>
<br/>
<br/>
Select Get Windows from Microsoft and follow the setup process.
<br/>
<br/>
<img src="https://imgur.com/0H9QV1v.png" height="80%" width="80%"/>
<br/>
<br/>
Configure the network adapter to use a bridged network so the VM is on the same network as the host machine so the Nessus implementation can talk to the VM more easily.
<br/>
<br/>
<img src="https://imgur.com/K0D40M4.png" height="80%" width="80%"/>
<br/>
<br/>
After configuring the network settings for your VM, go ahead and start the machine.
<br/>
<br/>
We'll be using the Windows 11 Pro edition and follow the normal steps for deploying a new virtual machine.
<br/>
<br/>
<img src="https://imgur.com/lk5z1lP.png" height="80%" width="80%"/>
<br/>
<br/>
Microsoft does prompt you to sign into your Microsoft account or to create one if you don't have one.
<br/>
<br/>
In order to bypass this, we will disconnect our network adapter once that screen has appeared, press SHIFT+F10 to open the Windows 11 command prompt, and run the command: oobe\bypassnro
<br/>
<br/>
This will reset the VM and allow you to bypass the Microsoft account screen by continuing with limited setup.
<br/>
<br/>
Once logged into the machine, connect the network adapter again and you will have internet connectivity.
<br/>
<br/>

<h2>Retrieve IPv4 Address:</h2>

<p align="center">
<br/> 
Now that we're logged into our Windows 11 VM, we'll open the command line and run ipconfig to get our IP address.
<br/>
<br/>
Beside that, we'll open up the command line on our host machine and ping the IP address of the virtual machine.
<br/>
<br/>
<img src="https://imgur.com/LqSyksV.png" height="80%" width="80%"/>
<br/>
<br/>
Notice it is not responding.
<br/>
<br/>
So let's go back to our virtual machine and disable our Windows firewall for the Domain, Private, and Public profiles and try it again.
<br/>
<br/>
<img src="https://imgur.com/j3LJDGj.png" height="80%" width="80%"/>
<br/>
<br/>
Now we see that there is connectivity and can move on.
<br/>
<br/>
<img src="https://imgur.com/JPCnvNG.png" height="80%" width="80%"/>
<br/>
<br/>

<h2>Create a New Scan:</h2>

<p align="center">
<br/> 
Now head over to Nessus on your host machine where you should be logged in already, and create a new scan.
<br/>
<br/>
<img src="https://imgur.com/EdN9TRQ.png" height="80%" width="80%"/>
<br/>
<br/>
Select Basic Network Scan
<br/>
<br/>
<img src="https://imgur.com/rTSS0Rg.png" height="80%" width="80%"/>
<br/>
<br/>
Give it a name and input your targets into the text box. Our target is our Windows 11 VM, so we'll type in the IP address for that machine.
<br/>
<br/>
In a real world scenario, we would also include a description and select the designated folder if we had one.
<br/>
<br/>
<img src="https://imgur.com/j7UPCS9.png" height="80%" width="80%"/>
<br/>
<br/>
We will leave everything else as-is for now and save our new scan.
<br/>
<br/>
Now let's run a scan of the network by clicking the run button on the right.
<br/>
<br/>
<img src="https://imgur.com/Aqp2YgD.png" height="80%" width="80%"/>
<br/>
<br/>
After a few minutes, we see the scan has completed. Let's click inside of it to view the details of the scan.
<br/>
<br/>
We can view the hosts, the specific vulnerabilities that were found, their CVSS scores, and recommended solutions to implement in order to remediate the vulnerabilities, along with much more.
<br/>
<br/>
<img src="https://imgur.com/h0cREoU.png"height="80%" width="80%"/>
<br/>
<br/>
<img src="https://imgur.com/1CfQgwV.png"height="80%" width="80%"/>
<br/>
<br/>
<img src="https://imgur.com/Hsx2KWI.png" height="80%" width="80%"/>
<br/>
<br/>
<img src="https://imgur.com/vBbjszZ.png"height="80%" width="80%"/>
<br/>
<br/>
<img src="https://imgur.com/P8mwrMb.png"height="80%" width="80%"/>
<br/>
<br/>
This scan shows that the system is fairly secure, with no high or critical level vulnerabilities. However, we didn't use any credentials for this scan, so we aren't seeing that much of what might be actually vulnerable.
<br/>
<br/>
 
<h2>Credentialed Scan:</h2>

<p align="center">
<br/>
Knowing that we didn't use any credentials for the last scan, we're now going to set up the virtual machine to accept authenticated scans, provide credentials to Nessus, and rescan the machine to compare the differences.
<br/>
<br/>
So let's go back to our Windows 11 VM and open Services.
<br/>
<br/>
Following the instructions provided by Nessus on how to do credentialed scans, we'll enable Remote Registry and press Start to actually allow it to run.
<br/>
<br/>
<img src="https://imgur.com/8yh4IrI.png" height="80%" width="80%"/>
<br/>
<br/>
<img src="https://imgur.com/8EJn1rS.png" height="80%" width="80%"/>
<br/>
<br/>
Now open up the User Account Settings and disable it.
<br/>
<br/>
<img src="https://imgur.com/CzBPj0j.png" height="80%" width="80%"/>
<br/>
<br/>
After that's completed, open the Registry Editor and add a key that's supposed to allow the remote account to connect in.
<br/>
<br/>
To add the key we need to locate the System folder within our HKEY_LOCAL_MACHINE. The path should look something like this:
<br/>
<br/>
Computer\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
<br/>
<br/>
Right click inside the folder and add a DWORD Value called LocalAccountTokenFilterPolicy.
<br/>
<br/>
<img src="https://imgur.com/xUFz6x9.png" height="80%" width="80%"/>
<br/>
<br/>
Double click the DWORD that we just created and set the value to 1.
<br/>
<br/>
<img src="https://imgur.com/x9BU5YF.png" height="80%" width="80%"/>
<br/>
<br/>
Restart the virtual machine then head back over to Nessus on the host machine.
<br/>
<br/>
Now we'll add a set of Windows credentials to our scan configuration.
<br/>
<br/>
<img src="https://imgur.com/iexBhab.png" height="80%" width="80%"/>
<br/>
<br/>
<img src="https://imgur.com/oXYfX82.png" height="80%" width="80%"/>
<br/>
<br/>
We'll need the name of our user on the virtual machine, so let's confirm that real quick by going into the virtual machine command line and running the command, whoami.
<br/>
<br/>
<img src="https://imgur.com/j0lhkZc.png" height="80%" width="80%"/>
<br/>
<br/>
Now that we know that, we can add the credentials by inputting the username and password for our Windows 11 user and leave the rest as-is.
<br/>
<br/>
<img src="https://imgur.com/EM1q3hv.png" height="80%" width="80%"/>
<br/>
<br/>
We can save the new configuration and run the credentialed scan.
<br/>
<br/>
<img src="https://imgur.com/OMR4hoX.png" height="80%" width="80%"/>
<br/>
<br/>
Now we see A LOT more results with this scan since we enabled credentialed scanning and configured the VM to accept remote scans.
<br/>
<br/>
Just like the first scan, we can dive deep into all of the vulnerabilities and the recommended actions to take.
<br/>
<br/>
<img src="https://imgur.com/JAi6KJ3.png" height="80%" width="80%"/>
<br/>
<br/>
<img src="https://imgur.com/HwIw09x.png" height="80%" width="80%"/>
<br/>
<br/>
<img src="https://imgur.com/pIyJTZE.png" height="80%" width="80%"/>
<br/>
<br/>
This signifies the importance of running credentialed scans vs uncredentialed scans as you can discover more vulnerabilities.
<br/>
<br/>
Before we begin to remediate some of these vulnerabilities, we'll install a deprecated version of Firefox on the virtual machine and run another scan to observe the results and just how effective Nessus can be at detecting vulnerabilities.
<br/>
<br/>

<h2>Install Deprecated Firefox on VM:</h2>

<p align="center">
<br/>
You can safely install a deprecated version of Firefox onto your virtual machine directly from their website.
<br/>
<br/>
Make sure to install it on your virtual machine and NOT your host machine.
<br/>
<br/>
<img src="https://imgur.com/RHCq3Ot.png" height="80%" width="80%"/>
<br/>
<br/>
After installing the deprecated version of Firefox, there is no need to open it. Just go back to Nessus on your host machine and perform another scan.
<br/>
<br/>
<img src="https://imgur.com/kwrOPPz.png" height="80%" width="80%"/>
<br/>
<br/>
Now we see that our vulnerabilities increased even more, with a ton of critical level vulnerabilities.
<br/>
<br/>
<img src="https://imgur.com/Z55GOYL.png" height="80%" width="80%"/>
<br/>
<br/>
If we click into vulnerabilities, we see that the scan did its job and picked up the deprecated version of Firefox. 
<br/>
<br/>
We also see that is where the majority of vulnerabilities are being detected from.
<br/>
<br/>
<img src="https://imgur.com/EHgPvmu.png" height="80%" width="80%"/>
<br/>
<br/>

<h2>Remediate Vulnerabilities:</h2>

<p align="center">
<br/>
We've now explored some of what Nessus has to offer and can begin remediating some of the vulnerabilities.
<br/>
<br/>
First, we'll deal with the deprecated version of Firefox. We could update to the latest version as recommended, but for this project, we'll simply uninstall it.
<br/>
<br/>
<img src="https://imgur.com/QJt6ELH.png" height="80%" width="80%"/>
<br/>
<br/>
Next, we'll check for Windows updates and install any updates that are available.
<br/>
<br/>
<img src="https://imgur.com/ieS19mi.png" height="80%" width="80%"/>
<br/>
<br/>
<img src="https://imgur.com/7Lc2HPY.png" height="80%" width="80%"/>
<br/>
<br/>
<img src="https://imgur.com/EA4XvcR.png" height="80%" width="80%"/>
<br/>
<br/>
The system will restart following the updates.
<br/>
<br/>
Once the machine has restarted, we will perform one last scan with Nessus to see if it had any effects.
<br/>
<br/>
<img src="https://imgur.com/JOtvXvo.png" height="80%" width="80%"/>
<br/>
<br/>
After completing the scan, we see that there was a major change here. We went from 86 criticals and 111 high level vulnerabilities, to 0 criticals and 7 high level vulnerabilities simply from uninstalling Firefox and updating Windows.
<br/>
<br/>
<img src="https://imgur.com/0ZMaOmv.png" height="80%" width="80%"/>
<br/>
<br/>
<img src="https://imgur.com/cFSp9Pw.png" height="80%" width="80%"/>
<br/>
<br/>
We could remediate more of these vulnerabilities through hardening techniques, program specific updates, and various other ways. But since this is a lab environment, we will end it here.


<p align="center">
<br/>

</p>

<br/>
<br/>


<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
--!>
